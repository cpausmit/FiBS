#!/bin/bash
#---------------------------------------------------------------------------------------------------
# Startup FiBS engine on a given machine with specific log file.
#---------------------------------------------------------------------------------------------------
# make sure the syste, has been setup
[ -z "$FIBS_BASE" ] && ( echo "FIBS is not setup. EXIT!"; exit 1; )

CLIENT="$1"
TASK="$2"
if [ "$CLIENT" == "" ] || [ "$TASK" == "" ]
then
  echo ""; echo " Please specify client and task as parameter. EXIT!"; echo ""
  exit 1
fi

# setup FiBS
source /home/cmsprod/FiBS/setup.sh

isRunning=`ssh -x $CLIENT "ps auxw|grep fibsEngine.py|grep ${TASK}.cfg|grep -v grep|cut -d' ' -f1"`
if [ "$isRunning" != "" ]
then
  echo "RUNNING -- fibs engine (config:$TASK) is running on $CLIENT"
  exit 1
else
  echo "No engine (config:$TASK) runs on $CLIENT."
fi

exit 0
